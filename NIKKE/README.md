# 使用方法

> ❗❗❗注意事项
> 
> - 暂不清楚使用此类软件是否会被视为外挂而被封禁账号，其他游戏比如明日方舟的[MAA](https://github.com/MaaAssistantArknights/MaaAssistantArknights)和碧蓝航线的[ALAS](https://github.com/LmeSzinc/AzurLaneAutoScript)，都也是基于图像识别的自动化软件，似乎并没有出现封禁的情况。至于NIKKE如何，自求多福吧。建议有顾虑但又想尝试的人可以先使用小号尝试，并使用模拟器、沙盒之类的方式将运行环境与其他手游和重要APP隔离开来；
> - 运行脚本时，由于需要进行频繁的文字识别或图像匹配，可能会增加不少耗电量，不太确定；
> - 脚本仅对本人使用的设备（分辨率2400×1080，竖屏）做了适配，不清楚对其他设备的兼容如何，因此**只建议愿意和喜欢折腾的人尝试**，不一定能正常使用（2023/02/04更新: 经尝试，模拟器上使用尚且算可用），如果遇到问题欢迎反馈

## 安装AutoX.js

AutoX.js在初版Auto.js（现为[Auto.js Pro](https://pro.autojs.org/)）的基础上发展而来，是一个支持无障碍服务的Android平台上的JavaScript运行环境和开发环境。可以从[这里](https://github.com/kkevsekk1/AutoX#autoxjs%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80)下载到AutoX.js。

在手机上安装好AutoX.js之后，还需要做一系列的权限配置才能保证其正常运行。视不同设备而定，可能包括以下方面：

- 无障碍服务
- 应用启动相关权限（自启动、关联启动、后台启动等等）
- 用电管理/电池管理

## 下载脚本文件

### 直接通过脚本更新（推荐）

可以只下载[最新release](https://github.com/Zebartin/autoxjs-scripts/releases/latest)中的`NIKKE.js`到AutoX.js的脚本目录下。将其重命名为`NIKKE设置.js`，运行该脚本，点击底部“更新脚本”按钮，等待片刻，即可将所有所需文件下载到当前目录下。打开软件右上角的日志，可以查看具体的更新内容。

> ❗注意：这种方式会将原有同名文件全部覆盖，如果自行修改过某些文件，请谨慎使用该功能。

### 手动下载所有内容

下载[最新release](https://github.com/Zebartin/autoxjs-scripts/releases/latest)中的压缩包，把其中的文件解压到AutoX.js的脚本目录下（一般在内部存储主目录下，名为`/脚本/`，如果没有，自行新建一个空脚本保存后就会出现）。

如果想使用最新的commit版本，则注意切换到dev分支，将父目录的`utils.js`和本目录的文件都放到AutoX.js的脚本目录下。

其中以下文件不需要复制：

- `NIKKE活动.js`;
- `NIKKE12月活动.js`;
- `*.md`
- `tools`目录

`images/`应保持文件夹结构，不要单独拿出来。

## 修改脚本内容（可选）

打开AutoX.js，可以修改各个脚本。如果想要尝试自动解锁手机屏幕的功能，需要修改`utils.js`中的第一行代码。比如，如果锁屏密码是123456，则作以下修改（注意不要改动英文引号）：

```diff
- const 手机锁屏密码 = '';
+ const 手机锁屏密码 = '123456';
```

## 运行脚本

运行`NIKKE设置.js`，打开设置界面。完成设置后点击底部按钮保存设置。

运行脚本之前需要额外做好一些设置：

- 建议使用**分辨率在1080×1920及以上、像素密度240DPI及以上**的设备/模拟器，否则OCR可能识别不出较小的字符，如果遇到OCR精度问题，可以尝试调高分辨率或像素密度；
- 游戏内和模拟器都设置为**竖屏**，暂不支持横屏运行；
- 设置游戏使用**简体中文**；
- 如果能够进入付费商店，在游戏时会时不时地出现“限时礼包”，需要勾选上“游戏中会出现限时礼包”一项；
- 勾选“游戏已启动”选项时，脚本不再尝试自行打开游戏，可用于ourplay/gspace/Gbox等使用场景，**在这些使用场景中，脚本出错重试功能无效**；
- 如果勾选了“静音运行”，需要为AutoX.js打开“修改系统设置”这一权限；
- 如果游戏内有“每日签到”，且运行脚本时当天未打开过游戏，需要勾选上“等待每日签到出现”。如果游戏内没有“每日签到”，勾选此选项不会有太大的副作用；
- 如果勾选了“v2rayNG魔法”，需要配置好v2rayNG。如果没有勾选或没有v2rayNG这一app，需要自行启动加速器/科学上网工具。

保证游戏处于关闭状态，或者游戏界面位于首页大厅位置，运行`NIKKE日常.js`，将会依次完成设置中涉及到的任务，包括：

- 购买商店免费商品，进行一次免费刷新，并按需购买代码手册；
- 进行派遣/领取派遣奖励，完成免费的一举歼灭，收取前哨基地奖励；
- 赠送一次友情点；
- 刷完新人竞技场免费次数，尝试领取特殊竞技场奖励；
- 尝试企业塔；
- 消耗所有咨询次数，依次咨询列表上的对象（建议事先设置好特殊关照对象）。具体可咨询的妮姬可以参考`nikke.json`文件内容或者[GAMEKEE NIKKE wiki页面](https://nikke.gamekee.com/575965.html)和[繁中服玩家整理的Google表格](https://docs.google.com/spreadsheets/d/1K_oGZWL4uvuqYM9JL2l5Kb-L0IXIuyrDI347b6rurho/edit#gid=161504329)。在此感谢相关攻略组和玩家的悉心整理；
- 反复刷取模拟室3A，目标是刷满特定的SSR级增益效果（无视形状），之后尝试选定难度的模拟室直到成功，可选3B~5C；
- 完成其他每日任务，包括一次社交点数招募和一次装备强化，后者会选择强化材料的第一个进行消耗。二者完成后领取每日任务、周任务和成就奖励。

**如果开始运行后没有反应，或者只是打开了一下游戏，可能是没有给AutoX.js打开足够的权限。此时可以尝试打开悬浮窗，再运行脚本。**

## 其他脚本的用途

- 如果想单独运行模拟室任务，可以在设置里取消掉其他任务，或者单独运行`模拟室.js`即可，前提是运行`模拟室.js`时，手机画面位于模拟室首页位置（有“开始模拟”按钮）；
- 如果已经选定关卡，且画面右下角有“进入战斗”按钮，运行`NIKKEutils.js`将会进行刷关，直到活动代币耗尽为止；
- 在任意画面运行`utils.js`，等待5秒左右后，会在日志中输出当前画面的OCR结果。可以通过该结果判断当前设备的OCR精度是否符合预期。

## 遇到问题？/需要新功能？

尽量通过[GitHub Issue](https://github.com/Zebartin/autoxjs-scripts/issues)提出，也可加QQ群：692236206。
